<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wheel of Riches</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
<style>
body{font-family:Arial,sans-serif;background:#f4f4f9;display:flex;justify-content:center;align-items:center;min-height:100vh;margin:0}
.game-wrapper{background:white;padding:20px 40px;border-radius:15px;box-shadow:0 4px 12px rgba(0,0,0,0.1);width:95%;max-width:1200px;text-align:center}
#hiddenSentence{font-size:28px;margin:20px 0;text-align:center;word-spacing:15px;line-height:1.6}
.word-group{display:inline-block}
.letter-box{display:inline-block;width:45px;height:50px;margin:0 2px;border-radius:10px;background:#e0e0e0;text-align:center;line-height:50px;font-weight:bold;font-size:24px}
#letters{display:flex;flex-wrap:wrap;justify-content:center;opacity:0;transform:translateY(50px);transition:.5s;margin-top:20px}
#letters.show{opacity:1;transform:translateY(0)}
.letter-button{margin:2px;padding:10px;font-size:18px;width:40px;border-radius:10px;cursor:pointer;background:#e0e0e0;border:1px solid #ccc;color:#333}
.letter-button:disabled{cursor:not-allowed;background:#b0b0b0;color:#666}
.player-score{padding:15px;border-radius:15px;background:#f0f0f0;font-size:20px;transition:.3s}
.player-score.active{font-size:28px;font-weight:bold;background:#ffeaa7}
#winnerMessage{font-size:24px;font-weight:bold;margin-top:20px;color:green}
.menu-button{padding:15px 25px;margin:10px auto;display:block;border-radius:10px;font-weight:bold;background:#e0e0e0;border:2px solid #ccc;cursor:pointer;width:260px}
.menu-button:hover{background:#d0d0d0}
#pointer{position:absolute;top:0;left:50%;transform:translateX(-50%);width:0;height:0;border-left:15px solid transparent;border-right:15px solid transparent;border-top:25px solid red;z-index:2}
#game-area.hide,#main-menu.hide{display:none}
</style>
</head>
<body>
<div class="game-wrapper">
    <h1>Wheel of Riches</h1>
    <h2 style="margin-top:5px;font-weight:normal">Spin the wheel and guess the sentence</h2>

    <div id="main-menu">
        <button class="menu-button" id="pvc-button">PLAY VS COMPUTER</button>
        <button class="menu-button" id="pvp-button">2 PLAYERS</button>
    </div>

    <div id="game-area" class="hide">
        <div id="hiddenSentence">Loading...</div>
        <div id="winnerMessage"></div>
        <button id="newGameBtn" style="display:none;" class="menu-button">New Game</button>
        <div class="player-score active" id="score1Box">Player 1: $<span id="score1">0</span></div>
        <div class="player-score" id="score2Box">Player 2: $<span id="score2">0</span></div>
        <canvas id="wheelCanvas" width="400" height="400" style="border-radius:50%;cursor:pointer"></canvas>
        <div id="letters"></div>
        <button id="iKnowBtn" class="menu-button" style="width:200px;">I KNOW IT!</button>
    </div>
</div>

<script>
let allSentences=[],currentSentence="",hidden=[],currentPlayer=1,wheelValue=0,
scores={1:0,2:0},spinning=false,canSpin=true,isProcessingGuess=false,
solvingMode=false,solveStartHiddenCount=0,nextSolveIndex=0,unguessedLetters=[];

const ctx=document.getElementById("wheelCanvas").getContext("2d");
const wheelCanvas=document.getElementById("wheelCanvas");
const hiddenDisplay=document.getElementById("hiddenSentence");
const score1Box=document.getElementById("score1Box"),score2Box=document.getElementById("score2Box");
const score1Display=document.getElementById("score1"),score2Display=document.getElementById("score2");
const winnerMessage=document.getElementById("winnerMessage");
const lettersDiv=document.getElementById("letters");
const iKnowBtn=document.getElementById("iKnowBtn");
const pvcBtn=document.getElementById("pvc-button"),pvpBtn=document.getElementById("pvp-button");
const mainMenu=document.getElementById("main-menu"),gameArea=document.getElementById("game-area");
const newGameBtn=document.getElementById("newGameBtn");

const values=[100,200,300,400,500,750,1000,2500,5000];
const colors=["#1abc9c","#2ecc71","#3498db","#9b59b6","#e67e22","#e74c3c","#16a085","#f1c40f","#d35400"];
const radius=200,center=200;let rotation=0;const section=2*Math.PI/values.length;
function drawWheel(){
ctx.clearRect(0,0,400,400);
for(let i=0;i<values.length;i++){
const start=i*section+rotation,end=start+section;
ctx.beginPath();ctx.moveTo(center,center);ctx.arc(center,center,radius,start,end);ctx.closePath();
ctx.fillStyle=colors[i%colors.length];ctx.fill();ctx.stroke();
const angle=start+section/2,x=center+Math.cos(angle)*radius*0.7,y=center+Math.sin(angle)*radius*0.7;
ctx.save();ctx.translate(x,y);ctx.rotate(angle+Math.PI/2);
ctx.fillStyle="#fff";ctx.font="bold 16px Arial";ctx.textAlign="center";ctx.fillText("$"+values[i],0,0);
ctx.restore();}}
drawWheel();

function updateHiddenDisplay(){
hiddenDisplay.innerHTML="";
hidden.forEach(c=>{
const box=document.createElement("span");
box.className="letter-box";
box.textContent=c;
hiddenDisplay.appendChild(box);
});
}

function createLetterButtons(){
const all="ABCDEFGHIJKLMNOPQRSTUVWXYZ";
lettersDiv.innerHTML="";unguessedLetters=[];
for(let ch of all){
const b=document.createElement("button");
b.textContent=ch;b.className="letter-button";
b.onclick=()=>guessLetter(ch,b);
lettersDiv.appendChild(b);
unguessedLetters.push(ch);
}
}

function startGame(mode){
gameMode=mode;
mainMenu.classList.add("hide");gameArea.classList.remove("hide");
scores={1:0,2:0};currentPlayer=1;updateScores();drawWheel();newRound();
}

pvcBtn.onclick=()=>startGame('pvc');
pvpBtn.onclick=()=>startGame('pvp');
newGameBtn.onclick=()=>{mainMenu.classList.remove("hide");gameArea.classList.add("hide")};

function newRound(){
winnerMessage.textContent="";canSpin=true;spinning=false;isProcessingGuess=false;
solvingMode=false;updateActiveScore();iKnowBtn.disabled=false;
currentSentence=["HELLO WORLD","CODE COPILOT","WHEEL OF RICHES","GOOD LUCK"][Math.floor(Math.random()*4)];
hidden=currentSentence.split("").map(c=>/[A-Z]/.test(c)?"_":c);
updateHiddenDisplay();createLetterButtons();
}

function updateScores(){score1Display.textContent=scores[1];score2Display.textContent=scores[2];}
function updateActiveScore(){
score1Box.classList.toggle("active",currentPlayer===1);
score2Box.classList.toggle("active",currentPlayer===2);
}

function spinWheel(){
if(spinning||!canSpin)return;spinning=true;canSpin=false;
const target=Math.floor(Math.random()*values.length);
const rotations=4+Math.random()*2;
const finalRot=rotations*2*Math.PI-target*section;
let start=null;
function animate(ts){
if(!start)start=ts;
const p=Math.min((ts-start)/4000,1);
rotation=finalRot*(1-Math.pow(1-p,3));
drawWheel();
if(p<1)requestAnimationFrame(animate);else{
spinning=false;wheelValue=values[target];
lettersDiv.classList.add("show");
if(gameMode==='pvc'&&currentPlayer===2)setTimeout(cpuTurn,1000);
}}
requestAnimationFrame(animate);
}

iKnowBtn.onclick=()=>{
if(spinning||isProcessingGuess||!canSpin||solvingMode)return;
solvingMode=true;canSpin=false;iKnowBtn.disabled=true;
lettersDiv.classList.add("show");
solveStartHiddenCount=hidden.filter(c=>c==="_").length;
nextSolveIndex=hidden.findIndex(c=>c==="_");
alert(`Solve mode active!\nReveal letters in order.\nBonus: $${solveStartHiddenCount*500} if perfect.`);
};

function guessLetter(letter,btn){
if(isProcessingGuess)return;isProcessingGuess=true;
if(btn)btn.disabled=true;

if(solvingMode){
if(nextSolveIndex===-1)return;
const correct=currentSentence[nextSolveIndex];
if(letter===correct){
hidden[nextSolveIndex]=letter;
updateHiddenDisplay();
nextSolveIndex=hidden.findIndex((c,i)=>i>nextSolveIndex&&c==="_");
if(nextSolveIndex===-1){
const bonus=solveStartHiddenCount*500;
scores[currentPlayer]+=bonus;updateScores();
winnerMessage.textContent=`üéâ Player ${currentPlayer} solved perfectly +$${bonus}`;
endRound();
}else isProcessingGuess=false;
}else{
alert("‚ùå Wrong letter ‚Äî solve failed!");
switchTurn();
}}
else{
const idxs=[];for(let i=0;i<currentSentence.length;i++)if(currentSentence[i]===letter)idxs.push(i);
if(idxs.length>0){
for(let i of idxs)hidden[i]=letter;
updateHiddenDisplay();
scores[currentPlayer]+=idxs.length*wheelValue;updateScores();
if(!hidden.includes("_")){winnerMessage.textContent=`üéâ Player ${currentPlayer} wins!`;endRound();}
else isProcessingGuess=false;
}else switchTurn();
}
}

function cpuTurn(){
if(solvingMode||spinning)return;
const pick=unguessedLetters[Math.floor(Math.random()*unguessedLetters.length)];
const b=[...document.querySelectorAll(".letter-button")].find(x=>x.textContent===pick);
if(b&&!b.disabled)guessLetter(pick,b);
}

function switchTurn(){
currentPlayer=currentPlayer===1?2:1;updateActiveScore();
canSpin=true;isProcessingGuess=false;solvingMode=false;iKnowBtn.disabled=false;
if(gameMode==='pvc'&&currentPlayer===2)setTimeout(spinWheel,1000);
}

function endRound(){
canSpin=false;newGameBtn.style.display="block";
newGameBtn.textContent="Play Again";
newGameBtn.onclick=()=>newRound();
}
</script>
</body>
</html>
