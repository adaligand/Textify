<!DOCTYPE html>
<html lang="en">
<head>
Â  Â  <meta charset="UTF-8" />
Â  Â  <meta name="viewport" content="width=device-width,initial-scale=1" />
Â  Â  <title>Rocket1</title>
Â  Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
Â  Â  <style>
Â  Â  Â  Â  :root {
Â  Â  Â  Â  Â  Â  --sky-height: 400px;
Â  Â  Â  Â  Â  Â  --rocket-start-bottom: 5%;
Â  Â  Â  Â  }

Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  font-family: Arial, sans-serif;
Â  Â  Â  Â  Â  Â  background-color: #f0f8ff;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  min-height: 100vh;
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- Game Screens --- */
Â  Â  Â  Â  .screen {
Â  Â  Â  Â  Â  Â  width: 95%;
Â  Â  Â  Â  Â  Â  max-width: 1000px;
Â  Â  Â  Â  Â  Â  padding: 20px 40px 40px 40px;
Â  Â  Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  Â  Â  background-color: white;
Â  Â  Â  Â  Â  Â  border-radius: 15px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  }

Â  Â  Â  Â  #end-screen {
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  min-height: 400px;
Â  Â  Â  Â  }

Â  Â  Â  Â  #game-screen {
Â  Â  Â  Â  Â  Â  display: none;Â 
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  }
Â  Â  Â  Â  /* --- End Game Screens --- */

Â  Â  Â  Â  .title {
Â  Â  Â  Â  Â  Â  font-size: 40px;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  margin-bottom: 10px;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* --- HEADER LAYOUT --- */

Â  Â  Â  Â  .subtitle {
Â  Â  Â  Â  Â  Â  font-size: 20px;
Â  Â  Â  Â  Â  Â  margin-bottom: 10px;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  min-height: 1.2em;
Â  Â  Â  Â  }

Â  Â  Â  Â  .game-header {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  margin-bottom: 15px;
Â  Â  Â  Â  Â  Â  padding: 0 10px;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  gap: 15px; /* Espace entre les Ã©lÃ©ments */
Â  Â  Â  Â  }
Â  Â  Â  Â  .counter {
Â  Â  Â  Â  Â  Â  font-size: 24px;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  text-align: left;
Â  Â  Â  Â  Â  Â  flex: 1; /* 1/4 de la largeur */
Â  Â  Â  Â  }
Â  Â  Â  Â  /* Le sous-titre est maintenant dans le header */
Â  Â  Â  Â  #subtitle {
Â  Â  Â  Â  Â  Â  flex: 2; /* 2/4 de la largeur (centre) */
Â  Â  Â  Â  Â  Â  margin-bottom: 0; /* Plus de marge en bas */
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Nouveau conteneur pour les Ã©lÃ©ments de droite */
Â  Â  Â  Â  #header-right-group {
Â  Â  Â  Â  Â  Â  flex: 1; /* 1/4 de la largeur */
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: flex-end;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  gap: 20px; /* Espace entre le timer et les cÅ“urs */
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #timer-display {
Â  Â  Â  Â  Â  Â  Â font-size: 24px;
Â  Â  Â  Â  Â  Â  Â font-weight: bold;
Â  Â  Â  Â  Â  Â  Â text-align: center;
Â  Â  Â  Â  Â  Â  Â color: #555;
Â  Â  Â  Â  }
Â  Â  Â  Â  #lives-container {
Â  Â  Â  Â  Â  Â  font-size: 24px;
Â  Â  Â  Â  Â  Â  text-align: right;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* --- END HEADER LAYOUT --- */


Â  Â  Â  Â  .hide {
Â  Â  Â  Â  Â  Â  display: none;
Â  Â  Â  Â  }

Â  Â  Â  Â  .english-sentence {
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  Â  Â  font-size: 20px;
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  Â  Â  border: 2px solid #ccc;
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  background-color: #f9f9f9;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- ROCKET LAUNCH STYLES --- */

Â  Â  Â  Â  #sky-container {
Â  Â  Â  Â  Â  Â  Â position: relative;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  height: var(--sky-height);
Â  Â  Â  Â  Â  Â  background: linear-gradient(to top, #d4e8ff, #a3cfff);
Â  Â  Â  Â  Â  Â  border: 2px solid #aaa;
Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  Â  Â  overflow: hidden;Â 
Â  Â  Â  Â  Â  Â  margin-bottom: 0px;
Â  Â  Â  Â  Â  Â  Â padding-bottom: 0;
Â  Â  Â  Â  }
Â  Â  Â  Â  #rocket-wrapper {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  inset: 0;
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  Â  Â  pointer-events: none;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #rocket-img {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  width: 60px;
Â  Â  Â  Â  Â  Â  height: auto;
Â  Â  Â  Â  Â  Â  left: 50%;
Â  Â  Â  Â  Â  Â  bottom: var(--rocket-start-bottom);
Â  Â  Â  Â  Â  Â  transform: translateX(-50%);
Â  Â  Â  Â  Â  Â  z-index: 10; /* Z-index de la fusÃ©e */
Â  Â  Â  Â  Â  Â  transition: bottom 0.5s ease-in-out, transform 0.5s ease-in-out;
Â  Â  Â  Â  }

Â  Â  Â  Â  #rocket-img.crash {
Â  Â  Â  Â  Â  Â  bottom: -150px;
Â  Â  Â  Â  Â  Â  transform: translateX(-50%) rotate(45deg);
Â  Â  Â  Â  Â  Â  transition-duration: 1s, 1s;
Â  Â  Â  Â  Â  Â  transition-timing-function: ease-in;
Â  Â  Â  Â  }

Â  Â  Â  Â  #rocket-img.launch {
Â  Â  Â  Â  Â  Â  bottom: calc(var(--sky-height) + 200px);
Â  Â  Â  Â  Â  Â  transform: translateX(-50%);
Â  Â  Â  Â  Â  Â  transition-duration: 1.5s, 0.5s;
Â  Â  Â  Â  Â  Â  transition-timing-function: ease-out;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* --- STYLE pour le GIF d'explosion --- */
Â  Â  Â  Â  #explosion-gif {
Â  Â  Â  Â  Â  Â  Â position: absolute;
Â  Â  Â  Â  Â  Â  Â width: 100px; /* âœ… TAILLE FIXE */
Â  Â  Â  Â  Â  Â  Â height: 100px; /* âœ… TAILLE FIXE */
Â  Â  Â  Â  Â  Â  Â /* La position exacte (bottom/left) est dÃ©finie par JS */
Â  Â  Â  Â  Â  Â  Â z-index: 20;Â 
Â  Â  Â  Â  Â  Â  Â display: none;Â 
Â  Â  Â  Â  }


Â  Â  Â  Â  #cloud-area-wrapper {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  inset: 0;
Â  Â  Â  Â  Â  Â  pointer-events: none;
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  }

Â  Â  Â  Â  .cloud-option {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  z-index: 5;
Â  Â  Â  Â  Â  Â  pointer-events: auto;
Â  Â  Â  Â  Â  Â  font-size: 18px;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  color: #333;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  white-space: nowrap;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  padding: 30px 40px;Â 
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  background-image: url('https://adaligand.github.io/Textify/Sentences/cloud.png');
Â  Â  Â  Â  Â  Â  background-size: 100% 100%;Â 
Â  Â  Â  Â  Â  Â  background-repeat: no-repeat;
Â  Â  Â  Â  Â  Â  background-position: center;
Â  Â  Â  Â  Â  Â  background-color: transparent;Â 
Â  Â  Â  Â  Â  Â  border: none;Â 
Â  Â  Â  Â  Â  Â  border-radius: 0;Â 
Â  Â  Â  Â  Â  Â  box-shadow: none;Â 
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  transition: transform 0.2s, background-color 0.2s;
Â  Â  Â  Â  Â  Â  animation: float 4s ease-in-out infinite;
Â  Â  Â  Â  }

Â  Â  Â  Â  .cloud-option:hover {
Â  Â  Â  Â  Â  Â  transform: translateY(-8px);
Â  Â  Â  Â  }

Â  Â  Â  Â  .cloud-option.wrong {
Â  Â  Â  Â  Â  Â  background-image: url('https://adaligand.github.io/Textify/Sentences/cloudwrong.png') !important;
Â  Â  Â  Â  Â  Â  animation: none !important;Â 
Â  Â  Â  Â  Â  Â  color: #333 !important;
Â  Â  Â  Â  }


Â  Â  Â  Â  @keyframes float {
Â  Â  Â  Â  Â  Â  0% { transform: translateY(0px); }
Â  Â  Â  Â  Â  Â  50% { transform: translateY(-8px); }
Â  Â  Â  Â  Â  Â  100% { transform: translateY(0px); }
Â  Â  Â  Â  }


Â  Â  Â  Â  .controls-wrapper {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  flex-direction: row;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  margin-top: 15px;
Â  Â  Â  Â  Â  Â  gap: 15px;
Â  Â  Â  Â  Â  Â  min-height: 45px;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  }
Â  Â  Â  Â  .feedback {
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  font-size: 18px;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Generic Button Style */
Â  Â  Â  Â  .btn {
Â  Â  Â  Â  Â  Â  padding: 15px 30px;
Â  Â  Â  Â  Â  Â  font-size: 20px;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  background-color: #f9f9f9;
Â  Â  Â  Â  Â  Â  border: 2px solid #ccc;
Â  Â  Â  Â  Â  Â  color: #000000;
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  margin: 5px;
Â  Â  Â  Â  Â  Â  transition: transform 0.2s, background-color 0.2s;
Â  Â  Â  Â  }
Â  Â  Â  Â  .btn:hover {
Â  Â  Â  Â  Â  Â  background-color: #e0e0e0;
Â  Â  Â  Â  Â  Â  transform: translateY(-2px);
Â  Â  Â  Â  }

Â  Â  Â  Â  #feedback-row {
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  gap: 12px;
Â  Â  Â  Â  Â  Â  margin-top: 6px;
Â  Â  Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Responsive adjustments */
Â  Â  Â  Â  @media (max-width: 520px) {
Â  Â  Â  Â  Â  Â  Â .cloud-option { font-size: 14px; padding: 12px 16px; }
Â  Â  Â  Â  Â  Â  Â .english-sentence { font-size: 18px; }
Â  Â  Â  Â  Â  Â  Â .title { font-size: 30px; }
Â  Â  Â  Â  Â  Â  Â /* Ajustement pour le header sur mobile */
Â  Â  Â  Â  Â  Â  Â .game-header { flex-wrap: wrap; }
Â  Â  Â  Â  Â  Â  Â .counter { flex-basis: 50%; }
Â  Â  Â  Â  Â  Â  Â #header-right-group { flex-basis: 50%; }
Â  Â  Â  Â  Â  Â  Â #subtitle { flex-basis: 100%; order: 3; margin-top: 10px; } /* Move subtitle to bottom on mobile */
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body>
Â  Â  <div id="game-screen" class="screen">
Â  Â  Â  Â  <div class="title">Rocket Launch</div>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div class="game-header">
Â  Â  Â  Â  Â  Â  <div class="counter" id="sentenceCounter"></div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div class="subtitle" id="subtitle">Translate the sentence word by word.</div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div id="header-right-group">
Â  Â  Â  Â  Â  Â  Â  Â  <div id="timer-display">1:00</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="lives-container"></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="english-sentence" id="english-sentence"></div>

Â  Â  Â  Â  <div id="sky-container">
Â  Â  Â  Â  Â  Â  <div id="rocket-wrapper">
Â  Â  Â  Â  Â  Â  Â  Â  <img id="rocket-img"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  src="https://adaligand.github.io/Textify/Sentences/rocket.png"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alt="rocket">
Â  Â  Â  Â  Â  Â  Â  Â  <img id="explosion-gif"Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â src="https://adaligand.github.io/Textify/Sentences/explosion.gif"Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â alt="explosion"Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â class="hide">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div id="cloud-area-wrapper"></div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="feedback-row">
Â  Â  Â  Â  Â  Â  <div id="feedback" class="feedback hide"></div>
Â  Â  Â  Â  Â  Â  <button id="nextButton" class="btn hide" onclick="nextText()">Next</button>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div id="end-screen" class="screen hide">
Â  Â  Â  Â  <h2 class="title" id="end-title"></h2>
Â  Â  Â  Â  <div class="subtitle" id="end-subtitle"></div>
Â  Â  Â  Â  <button id="resetButton" class="btn" onclick="resetActivity()">Restart</button>
Â  Â  </div>

<script>
Â  Â  // --- Game State Variables ---
Â  Â  var currentTextIndex = 0;
Â  Â  var originalChunks = [];
Â  Â  var currentChunkIndex = 0;
Â  Â  var sentencePairs = [];
Â  Â  var allFrenchWords = [];
Â  Â  var isGameOver = false;
Â  Â  var lives = 3;
Â  Â  var sentenceTimerId = null;
Â  Â  var remainingTime = 60;
Â  Â  const CRASHANIMATIONDURATION = 1500;Â 
Â  Â  const EXPLOSION_DURATION = 1400;Â 
Â  Â  const LAUNCHANIMATIONDURATION = 2000;Â 

Â  Â  // --- DOM Elements ---
Â  Â  const gameScreen = document.getElementById('game-screen');
Â  Â  const endScreen = document.getElementById('end-screen');
Â  Â  const subtitle = document.getElementById('subtitle');
Â  Â  const rocket = document.getElementById('rocket-img');
Â  Â  const explosionGif = document.getElementById('explosion-gif');
Â  Â  const skyContainer = document.getElementById('sky-container');
Â  Â  const cloudAreaWrapper = document.getElementById('cloud-area-wrapper');
Â  Â  const sentenceCounter = document.getElementById('sentenceCounter');
Â  Â  const livesContainer = document.getElementById('lives-container');
Â  Â  const feedbackElement = document.getElementById('feedback');
Â  Â  const nextButton = document.getElementById('nextButton');
Â  Â  const englishSentenceEl = document.getElementById('english-sentence');
Â  Â  const timerDisplay = document.getElementById('timer-display');
Â  Â Â 
Â  Â  // --- Utility Functions ---
Â  Â Â 
Â  Â  /**
Â  Â  Â * MÃ©lange un tableau sur place.
Â  Â  Â */
Â  Â  function shuffleArray(array) {
Â  Â  Â  Â  for (var i = array.length - 1; i > 0; i--) {
Â  Â  Â  Â  Â  Â  var j = Math.floor(Math.random() * (i + 1));
Â  Â  Â  Â  Â  Â  var temp = array[i];
Â  Â  Â  Â  Â  Â  array[i] = array[j];
Â  Â  Â  Â  Â  Â  array[j] = temp;
Â  Â  Â  Â  }
Â  Â  Â  Â  return array;
Â  Â  }
Â  Â Â 
Â  Â  /**
Â  Â  Â * Retourne un nombre alÃ©atoire entre min (inclus) et max (exclus).
Â  Â  Â */
Â  Â  function randomInRange(min, max) {
Â  Â  Â  Â  Â  return Math.random() * (max - min) + min;
Â  Â  }

Â  Â  // --- CSV Loading ---
Â  Â  const params = new URLSearchParams(window.location.search);
Â  Â  const sheetUrl = params.get('sheet');

Â  Â  if (!sheetUrl) {
Â  Â  Â  Â  subtitle.textContent = "âš ï¸ No CSV URL provided.";Â 
Â  Â  Â  Â  gameScreen.style.display = 'flex';
Â  Â  } else {
Â  Â  Â  Â  subtitle.textContent = "Loading data...";
Â  Â  Â  Â  gameScreen.style.display = 'flex';
Â  Â  Â  Â  Papa.parse(sheetUrl, {
Â  Â  Â  Â  Â  Â  download: true,
Â  Â  Â  Â  Â  Â  header: true,
Â  Â  Â  Â  Â  Â  skipEmptyLines: true,
Â  Â  Â  Â  Â  Â  complete: function(results) {
Â  Â  Â  Â  Â  Â  Â  Â  let wordSet = new Set();
Â  Â  Â  Â  Â  Â  Â  Â  results.data.forEach(row => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (row["French sentences"] && row["English sentences"]) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const frenchSentence = row["French sentences"].trim();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  sentencePairs.push({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  english: row["English sentences"].trim(),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  french: frenchSentence
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  frenchSentence.split(/\s+/).filter(Boolean).forEach(word => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  wordSet.add(word);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  allFrenchWords = Array.from(wordSet);

Â  Â  Â  Â  Â  Â  Â  Â  if (sentencePairs.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  subtitle.textContent = "âš ï¸ No data found.";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  if (allFrenchWords.length < 8) {Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  subtitle.textContent = "âš ï¸ Not enough unique words.";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  subtitle.textContent = "Translate the sentence word by word.";
Â  Â  Â  Â  Â  Â  Â  Â  shuffleArray(sentencePairs);
Â  Â  Â  Â  Â  Â  Â  Â  startGame();
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  error: function(err) {
Â  Â  Â  Â  Â  Â  Â  Â  subtitle.textContent = "âš ï¸ Error loading the CSV file.";
Â  Â  Â  Â  Â  Â  Â  Â  console.error(err);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });
Â  Â  }

Â  Â  /**
Â  Â  Â * Called by CSV loader or Restart button.
Â  Â  Â */
Â  Â  function startGame() {
Â  Â  Â  Â  isGameOver = false;
Â  Â  Â  Â  currentTextIndex = 0;
Â  Â  Â  Â  lives = 3;
Â  Â  Â  Â  stopSentenceTimer();
Â  Â  Â  Â  shuffleArray(sentencePairs);

Â  Â  Â  Â  endScreen.classList.add('hide');
Â  Â  Â  Â  gameScreen.style.display = 'flex';
Â  Â  Â  Â  displaySentence();
Â  Â  }

Â  Â  function updateLivesDisplay() {
Â  Â  Â  Â  livesContainer.textContent = 'â¤ï¸'.repeat(lives) + 'ğŸ–¤'.repeat(3 - lives);
Â  Â  Â  Â  livesContainer.classList.remove('hide');
Â  Â  }

Â  Â  function startSentenceTimer() {
Â  Â  Â  Â  stopSentenceTimer();
Â  Â  Â  Â  remainingTime = 60;
Â  Â  Â  Â  updateTimerDisplay();

Â  Â  Â  Â  sentenceTimerId = setInterval(() => {
Â  Â  Â  Â  Â  Â  remainingTime--;
Â  Â  Â  Â  Â  Â  updateTimerDisplay();

Â  Â  Â  Â  Â  Â  if (remainingTime <= 0) {
Â  Â  Â  Â  Â  Â  Â  Â  stopSentenceTimer();
Â  Â  Â  Â  Â  Â  Â  Â  if (!isGameOver) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  triggerFailure(null);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }, 1000);
Â  Â  }

Â  Â  function stopSentenceTimer() {
Â  Â  Â  Â  if (sentenceTimerId) {
Â  Â  Â  Â  Â  Â  clearInterval(sentenceTimerId);
Â  Â  Â  Â  Â  Â  sentenceTimerId = null;
Â  Â  Â  Â  }
Â  Â  }

Â  Â  function updateTimerDisplay() {
Â  Â  Â  Â  const minutes = Math.floor(remainingTime / 60);
Â  Â  Â  Â  const seconds = remainingTime % 60;
Â  Â  Â  Â  timerDisplay.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
Â  Â  Â  Â  timerDisplay.style.color = remainingTime <= 10 ? 'red' : '#555';
Â  Â  }


Â  Â  /**
Â  Â  Â * Met Ã  jour le sous-titre avec la progression
Â  Â  Â * âœ… MODIFIÃ‰ : Ajout du style bleu gras pour les mots trouvÃ©s.
Â  Â  Â */
Â  Â  function updateSubtitleWithProgress() {
Â  Â  Â  Â  if (!originalChunks || originalChunks.length === 0) {
Â  Â  Â  Â  Â  Â  subtitle.textContent = "Translate the sentence word by word.";
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  let displayedText = "";
Â  Â  Â  Â  for (let i = 0; i < originalChunks.length; i++) {
Â  Â  Â  Â  Â  Â  if (i < currentChunkIndex) {
Â  Â  Â  Â  Â  Â  Â  Â  // âœ… Mots corrects affichÃ©s en bleu gras
Â  Â  Â  Â  Â  Â  Â  Â  const correctWord = originalChunks[i].join(' ');
Â  Â  Â  Â  Â  Â  Â  Â  displayedText += `<span style="color: #007bff; font-weight: bold;">${correctWord}</span> `;
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  // Le mot n'est pas encore trouvÃ© (affichÃ© comme un trou)
Â  Â  Â  Â  Â  Â  Â  Â  const wordLength = originalChunks[i].join(' ').length;
Â  Â  Â  Â  Â  Â  Â  Â  const blank = "_".repeat(Math.max(3, wordLength));Â 
Â  Â  Â  Â  Â  Â  Â  Â  displayedText += `<span style="color: #ccc; font-weight: bold;">${blank}</span> `;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â  subtitle.innerHTML = displayedText.trim();
Â  Â  }


Â  Â  /**
Â  Â  * Sets up the UI for the current sentence.
Â  Â  */
Â  Â  function displaySentence() {
Â  Â  Â  Â  if (currentTextIndex >= sentencePairs.length) {
Â  Â  Â  Â  Â  Â  // --- Activity Complete (WIN) ---
Â  Â  Â  Â  Â  Â  isGameOver = true;
Â  Â  Â  Â  Â  Â  stopSentenceTimer();
Â  Â  Â  Â  Â  Â  gameScreen.style.display = 'none';
Â  Â  Â  Â  Â  Â  endScreen.classList.remove('hide');
Â  Â  Â  Â  Â  Â  document.getElementById('end-title').textContent = 'ğŸ‰ You Win! ğŸ‰';
Â  Â  Â  Â  Â  Â  document.getElementById('end-subtitle').textContent = "You've completed all the sentences!";
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- Setup for new sentence ---
Â  Â  Â  Â  isGameOver = false;
Â  Â  Â  Â  var englishSentence = sentencePairs[currentTextIndex].english;
Â  Â  Â  Â  var frenchSentence = sentencePairs[currentTextIndex].french;
Â  Â  Â  Â  originalChunks = getWordChunks(frenchSentence);
Â  Â  Â  Â  currentChunkIndex = 0;

Â  Â  Â  Â  // --- Reset UI elements ---
Â  Â  Â  Â  englishSentenceEl.textContent = englishSentence;
Â  Â  Â  Â  updateLivesDisplay();
Â  Â  Â  Â Â 
Â  Â  Â  Â  cloudAreaWrapper.innerHTML = '';

Â  Â  Â  Â  // RÃ©initialisation de la fusÃ©e et du GIF
Â  Â  Â  Â  rocket.classList.remove('crash', 'launch');
Â  Â  Â  Â  rocket.style.transition = 'none';Â 
Â  Â  Â  Â  rocket.style.bottom = `var(--rocket-start-bottom)`;
Â  Â  Â  Â  rocket.style.transform = 'translateX(-50%) rotate(0deg)';
Â  Â  Â  Â  rocket.style.opacity = 1; // ROCKET VISIBLE
Â  Â  Â  Â  rocket.offsetHeight;Â 
Â  Â  Â  Â  rocket.style.transition = '';Â 
Â  Â  Â  Â Â 
Â  Â  Â  Â  explosionGif.classList.add('hide');Â 
Â  Â  Â  Â  explosionGif.style.display = 'none'; // GIF CACHÃ‰

Â  Â  Â  Â  feedbackElement.classList.add('hide');
Â  Â  Â  Â  nextButton.classList.add('hide');

Â  Â  Â  Â  sentenceCounter.textContent = (currentTextIndex + 1) + '/' + sentencePairs.length;
Â  Â  Â  Â  sentenceCounter.classList.remove('hide');
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Mettre Ã  jour la phrase avec les trous
Â  Â  Â  Â  updateSubtitleWithProgress();

Â  Â  Â  Â  // Afficher les nuages de mots
Â  Â  Â  Â  displayNextWordOptions();

Â  Â  Â  Â  startSentenceTimer();
Â  Â  }


Â  Â  /**
Â  Â  Â * Affiche 8 options de mots dans 8 zones alÃ©atoires non chevauchantes.
Â  Â  Â */
Â  Â  function displayNextWordOptions() {
Â  Â  Â  Â  cloudAreaWrapper.innerHTML = '';

Â  Â  Â  Â  let correctAnswer = originalChunks[currentChunkIndex].join(' ');
Â  Â  Â  Â  let options = [correctAnswer];

Â  Â  Â  Â  // 1. Obtenir 8 options (1 correcte + 7 fausses)
Â  Â  Â  Â  while (options.length < 8) {
Â  Â  Â  Â  Â  Â  let randomWord = allFrenchWords[Math.floor(Math.random() * allFrenchWords.length)];
Â  Â  Â  Â  Â  Â  if (!options.includes(randomWord) && randomWord.toLowerCase() !== correctAnswer.toLowerCase()) {
Â  Â  Â  Â  Â  Â  Â  Â  options.push(randomWord);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â  shuffleArray(options); // MÃ©langer les mots

Â  Â  Â  Â  // 2. DÃ©finir 8 "zones" (en %) qui ne se chevauchent pas
Â  Â  Â  Â  const zones = [
Â  Â  Â  Â  Â  Â  { top: [ 0, 5], left: [ 5, 20] },Â Â 
Â  Â  Â  Â  Â  Â  { top: [25, 30], left: [ 8, 25] },Â Â 
Â  Â  Â  Â  Â  Â  { top: [50, 55], left: [ 5, 20] },Â Â 
Â  Â  Â  Â  Â  Â  { top: [75, 80], left: [ 8, 25] },Â Â 
Â  Â  Â  Â  Â  Â  { top: [ 0, 5], left: [65, 80] },Â Â 
Â  Â  Â  Â  Â  Â  { top: [25, 30], left: [68, 85] },Â Â 
Â  Â  Â  Â  Â  Â  { top: [50, 55], left: [65, 80] },Â Â 
Â  Â  Â  Â  Â  Â  { top: [75, 80], left: [68, 85] }Â  Â 
Â  Â  Â  Â  ];
Â  Â  Â  Â Â 
Â  Â  Â  Â  // 3. MÃ©langer les zonesÂ 
Â  Â  Â  Â  shuffleArray(zones);

Â  Â  Â  Â  // 4. CrÃ©er les nuages et leur assigner une position alÃ©atoire DANS une zone
Â  Â  Â  Â  options.forEach((optionText, index) => {
Â  Â  Â  Â  Â  Â  const cloud = document.createElement('div');
Â  Â  Â  Â  Â  Â  cloud.classList.add('cloud-option');
Â  Â  Â  Â  Â  Â  cloud.textContent = optionText;

Â  Â  Â  Â  Â  Â  cloud.dataset.isCorrect = (optionText === correctAnswer);
Â  Â  Â  Â  Â  Â  cloud.onclick = () => checkAnswer(cloud);

Â  Â  Â  Â  Â  Â  const zone = zones[index];
Â  Â  Â  Â  Â  Â  const top = randomInRange(zone.top[0], zone.top[1]);
Â  Â  Â  Â  Â  Â  const left = randomInRange(zone.left[0], zone.left[1]);

Â  Â  Â  Â  Â  Â  cloud.style.top = top + '%';
Â  Â  Â  Â  Â  Â  cloud.style.left = left + '%';
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  cloudAreaWrapper.appendChild(cloud);
Â  Â  Â  Â  });

Â  Â  Â  Â  // 5. Mettre Ã  jour la fusÃ©e
Â  Â  Â  Â  let progress = (currentChunkIndex / originalChunks.length);
Â  Â  Â  Â  let newBottom = 5 + (progress * 80); // Bouge de 5% Ã  85%
Â  Â  Â  Â  rocket.style.bottom = `${newBottom}%`;
Â  Â  }


Â  Â  /**
Â  Â  Â * checkAnswer function logic
Â  Â  Â */
Â  Â  function checkAnswer(cloudElement) {
Â  Â  Â  Â  if (isGameOver) return;

Â  Â  Â  Â  let isCorrect = (cloudElement.dataset.isCorrect === 'true');

Â  Â  Â  Â  if (isCorrect) {
Â  Â  Â  Â  Â  Â  // --- CORRECT ANSWER ---
Â  Â  Â  Â  Â  Â  currentChunkIndex++;
Â  Â  Â  Â  Â  Â  // Mettre Ã  jour la phrase avec le mot correct
Â  Â  Â  Â  Â  Â  updateSubtitleWithProgress();

Â  Â  Â  Â  Â  Â if (currentChunkIndex === originalChunks.length) {
Â  Â  Â  Â  Â  Â  Â  Â  // --- SENTENCE FINISHED (LAUNCH!) ---
Â  Â  Â  Â  Â  Â  Â  Â  isGameOver = true;
Â  Â  Â  Â  Â  Â  Â  Â  stopSentenceTimer();
Â  Â  Â  Â  Â  Â  Â  Â  cloudAreaWrapper.innerHTML = '';Â 
Â  Â  Â  Â  Â  Â  Â  Â  rocket.style.bottom = '';Â 

Â  Â  Â  Â  Â  Â  Â  Â  triggerLaunch();

Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  feedbackElement.textContent = 'Great launch!';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  feedbackElement.style.color = 'green';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  feedbackElement.classList.remove('hide');

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  nextButton.classList.remove('hide');
Â  Â  Â  Â  Â  Â  Â  Â  }, LAUNCHANIMATIONDURATION);Â 

Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  // --- NOT FINISHED, SHOW NEXT WORD ---
Â  Â  Â  Â  Â  Â  Â  Â  displayNextWordOptions();
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  // --- WRONG ANSWER ---
Â  Â  Â  Â  Â  Â  triggerFailure(cloudElement);
Â  Â  Â  Â  }
Â  Â  }


Â  Â  /**
Â  Â  Â * Uses requestAnimationFrame to ensure the .launch animation triggers.
Â  Â  Â */
Â  Â  function triggerLaunch() {
Â  Â  Â  Â  rocket.classList.remove('launch');Â 
Â  Â  Â  Â  void rocket.offsetWidth;Â 

Â  Â  Â  Â  requestAnimationFrame(() => {
Â  Â  Â  Â  Â  Â  rocket.classList.add('launch');
Â  Â  Â  Â  });
Â  Â  }


Â  Â  /**
Â  Â  Â * Triggers the rocket failure animation
Â  Â  Â */
Â  Â  function triggerFailure(wrongCloudElement) {
Â  Â  Â  Â  if (isGameOver) return;
Â  Â  Â  Â  isGameOver = true;
Â  Â  Â  Â  stopSentenceTimer();

Â  Â  Â  Â  if (wrongCloudElement) wrongCloudElement.classList.add('wrong');Â 

Â  Â  Â  Â  rocket.classList.remove('crash', 'launch');
Â  Â  Â  Â  void rocket.offsetWidth;Â 

Â  Â  Â  Â  lives--;
Â  Â  Â  Â  updateLivesDisplay();

Â  Â  Â  Â  if (lives <= 0) {
Â  Â  Â  Â  Â  Â  // --- GAME OVER (0 VIES) : EXPLOSION ET AFFICHAGE DU GIF ---
Â  Â  Â  Â  Â  Â  feedbackElement.classList.add('hide');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // 1. Positionner le GIF exactement lÃ  oÃ¹ se trouve la fusÃ©e
Â  Â  Â  Â  Â  Â  const rocketRect = rocket.getBoundingClientRect();
Â  Â  Â  Â  Â  Â  const skyRect = skyContainer.getBoundingClientRect();

Â  Â  Â  Â  Â  Â  // Calculer la position 'bottom' et 'left' relative au skyContainer
Â  Â  Â  Â  Â  Â  const currentRocketBottom = skyRect.height - (rocketRect.bottom - skyRect.top);
Â  Â  Â  Â  Â  Â  const currentRocketLeft = rocketRect.left - skyRect.left;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Appliquer la position au GIF
Â  Â  Â  Â  Â  Â  // On positionne le GIF au centre de la position actuelle de la fusÃ©e.
Â  Â  Â  Â  Â  Â  explosionGif.style.bottom = `${currentRocketBottom}px`;Â 
Â  Â  Â  Â  Â  Â  explosionGif.style.left = `${currentRocketLeft + rocketRect.width / 2}px`;
Â  Â  Â  Â  Â  Â  explosionGif.style.transform = `translateX(-50%)`;Â 

Â  Â  Â  Â  Â  Â  // 2. Masquer la fusÃ©e et afficher le GIF d'explosion
Â  Â  Â  Â  Â  Â  rocket.style.opacity = '0'; // Masque la fusÃ©e pour laisser place au GIF
Â  Â  Â  Â  Â  Â  explosionGif.classList.remove('hide'); // Affiche le GIF (retire display:none)
Â  Â  Â  Â  Â  Â  explosionGif.style.display = 'block'; // S'assure qu'il est visible

Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  // 3. AprÃ¨s l'animation du GIF, passer Ã  l'Ã©cran de fin
Â  Â  Â  Â  Â  Â  Â  Â  gameScreen.style.display = 'none';
Â  Â  Â  Â  Â  Â  Â  Â  endScreen.classList.remove('hide');
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('end-title').textContent = 'ğŸ’¥ Game Over ğŸ’¥';
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('end-subtitle').textContent = 'You ran out of lives.';
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // RÃ©initialiser l'opacitÃ© de la fusÃ©e et le display du GIF
Â  Â  Â  Â  Â  Â  Â  Â  rocket.style.opacity = '1';
Â  Â  Â  Â  Â  Â  Â  Â  explosionGif.classList.add('hide');
Â  Â  Â  Â  Â  Â  Â  Â  explosionGif.style.display = 'none';
Â  Â  Â  Â  Â  Â  }, EXPLOSION_DURATION);Â 

Â  Â  Â  Â  Â  Â  return;Â 
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- CRASH (Reste des vies) ---
Â  Â  Â  Â  requestAnimationFrame(() => {
Â  Â  Â  Â  Â  Â  rocket.classList.add('crash');
Â  Â  Â  Â  });

Â  Â  Â  Â  feedbackElement.textContent = wrongCloudElement
Â  Â  Â  Â  Â  Â  ? 'Oh no, a wrong word! Try this sentence again.'
Â  Â  Â  Â  Â  Â  : 'Time\'s up! The rocket crashed!';
Â  Â  Â  Â  feedbackElement.style.color = 'red';
Â  Â  Â  Â  feedbackElement.classList.remove('hide');

Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  if (wrongCloudElement) wrongCloudElement.classList.remove('wrong');

Â  Â  Â  Â  Â  Â  if (lives > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  displaySentence();Â 
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â rocket.classList.remove('crash');
Â  Â  Â  Â  Â  Â  Â  Â  Â gameScreen.style.display = 'none';
Â  Â  Â  Â  Â  Â  Â  Â  Â endScreen.classList.remove('hide');
Â  Â  Â  Â  Â  Â  Â  Â  Â document.getElementById('end-title').textContent = 'ğŸ˜ Game Over ğŸ˜';
Â  Â  Â  Â  Â  Â  Â  Â  Â document.getElementById('end-subtitle').textContent = 'You ran out of lives.';
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }, CRASHANIMATIONDURATION);Â 
Â  Â  }

Â  Â  function nextText() {
Â  Â  Â  Â  stopSentenceTimer();
Â  Â  Â  Â  currentTextIndex++;
Â  Â  Â  Â  displaySentence();Â 
Â  Â  }

Â  Â  function resetActivity() {
Â  Â  Â  Â  startGame();
Â  Â  }

Â  Â  // --- Utility Functions ---

Â  Â  function getWordChunks(text) {
Â  Â  Â  Â  var words = text.split(/\s+/).filter(Boolean);
Â  Â  Â  Â  var chunks = [];
Â  Â  Â  Â  for (var i = 0; i < words.length; i++) {
Â  Â  Â  Â  Â  Â  chunks.push([words[i]]);
Â  Â  Â  Â  }
Â  Â  Â  Â  return chunks;
Â  Â  }
</script>
</body>
</html> 
