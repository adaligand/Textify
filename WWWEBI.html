<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GCSE Feedback</title>
    <style>
        :root {
            --bg: #f5f6f7;
            --border: #d1d5db;
            --panel: #ffffff;
            --accent: #4b5563;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background-color: var(--bg);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
        }

        .dashboard {
            display: grid;
            grid-template-columns: 1.6fr 1fr;
            gap: 25px;
            max-width: 1500px;
            width: 100%;
        }

        .panel {
            background: var(--panel);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--border);
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        h2 { font-weight: 500; color: var(--accent); margin-top: 0; font-size: 1.2rem; border-bottom: 2px solid var(--bg); padding-bottom: 10px; }

        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid var(--border); padding: 12px; text-align: left; position: relative; }
        th { background: #f9fafb; font-size: 0.75rem; text-transform: uppercase; color: #6b7280; }
        .cat-cell { background: #fefefe; font-weight: 600; width: 110px; color: #374151; font-size: 0.9rem; }

        .dropdown-container { position: relative; width: 100%; }
        
        .dropdown-button {
            width: 100%;
            padding: 10px;
            background: white;
            border: 1px solid var(--border);
            border-radius: 4px;
            text-align: left;
            cursor: pointer;
            font-size: 0.85rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .dropdown-menu {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            width: 110%; /* Slightly wider for longer phrases */
            background: white;
            border: 1px solid var(--border);
            z-index: 100;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
            max-height: 350px;
            overflow-y: auto;
            padding: 5px 0;
        }

        .dropdown-menu.show { display: block; }

        .dropdown-item {
            padding: 8px 12px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
            font-size: 0.85rem;
            cursor: pointer;
            border-bottom: 1px solid #f9fafb;
        }

        .dropdown-item:hover { background-color: #f3f4f6; }
        .dropdown-item input { margin-top: 3px; }

        .tense-inline {
            margin-left: 5px;
            font-size: 0.75rem;
            padding: 1px;
            border: 1px solid #ccc;
            background: #fff9c4;
        }

        .sticky-side { position: sticky; top: 20px; height: fit-content; }
        .output-box {
            background: #f9fafb;
            border: 1px solid var(--border);
            padding: 20px;
            min-height: 400px;
            white-space: pre-line;
            font-family: 'Courier New', monospace;
            font-size: 1rem;
            margin-bottom: 20px;
        }

        .btn-group { display: flex; gap: 10px; }
        .btn { flex: 1; padding: 14px; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; }
        .btn-copy { background: #1f2937; color: white; }
        .btn-clear { background: #e5e7eb; color: #374151; }

        .badge { background: #3b82f6; color: white; padding: 2px 6px; border-radius: 10px; font-size: 0.7rem; }
    </style>
</head>
<body>

<div class="dashboard">
    <div class="panel">
        <h2>GCSE Feedback</h2>
        <table>
            <thead>
                <tr>
                    <th>Category</th>
                    <th>WWW</th>
                    <th>EBI</th>
                </tr>
            </thead>
            <tbody id="table-body"></tbody>
        </table>
    </div>

    <div class="panel sticky-side">
        <h2>Live Preview</h2>
        <div id="output" class="output-box">Select phrases...</div>
        <div class="btn-group">
            <button class="btn btn-copy" onclick="copyResult()">Copy Feedback</button>
            <button class="btn btn-clear" onclick="resetForm()">Clear</button>
        </div>
    </div>
</div>

<script>
    const tenses = ["present", "past", "imperfect", "future", "conditional","past and future"];
    
    // Updated feedback based on your provided content
    const feedback = {
        "Content": { 
            www: ["You covered all the bullet points", "You developed most of your answers fully", "Your answers are reasonably well developed", "You developed your answers fully", "You provided extra details"], 
            ebi: ["Cover all bullet points", "Make sure you do not go off topic", "Develop all answers fully", "Make sure you understand what the question is asking you to do so that you don't end up answering another question"] 
        },
        "Accuracy": { 
            www: ["Your work is very accurate", "Your work is accurate overall", "Your work is mostly accurate"], 
            ebi: ["Proofread for meaning/missing words", "Proofread for word order", "Check your verb endings", "Proofread for gender/number of words", "Proofread for accuracy on key phrases (eg choice of article, preposition...)", "Proofread for spellings"] 
        },
        "Vocab": { 
            www: ["You have started to vary your vocabulary and ideas", "Your vocab and ideas are varied", "You have a wide range of vocabulary", "Good research of vocab/you have used some of your own vocab"], 
            ebi: ["Use a wider range of vocab/ideas", "Avoid repetitions to enable you to fit in more ideas", "Use your exercise book to check key vocab and phrases learned in class", "Do not overuse the dictionary as it creates confusions"] 
        },
        "Op/reasons": { 
            www: ["You provided a few opinions", "You provided a few opinions/reasons", "You provided some opinions/reasons", "You provided a good range of opinions"], 
            ebi: ["Provide some opinions/reasons", "Provide opinions/reasons more often", "Provide reasons for opinions", "Provide reasons more often", "Provide opinions more often and give reasons for opinions"] 
        },
        "Tenses": { 
            www: ["You used the abc tense mostly successfully", "You used your tenses mostly successfully", "You used your tenses successfully", "You used the abc tense successfully", "Good range of verbs in abc tense", "Good range of verbs in different tenses"], 
            ebi: ["Revise/practise the abc tense", "Develop your use of the abc tense", "Develop your use of tenses", "Make sure you answer in the tense asked by the question"] 
        },
        "Complexity": { 
            www: ["You included a few complex phrases successfully", "You included some complex phrases successfully", "You included a wide range of complex phrases successfully", "You included some idiomatic phrases"], 
            ebi: ["Use some complex phrases", "Use a wider range of complex phrases", "Try to incorporate some of the 7+ structures in your work"] 
        },
        "Fluency": { 
            www: ["You used some connectives/time phrases to link your sentences together", "You used a good range of connectives/time phrases", "Your work is well structured and well balanced", "Your work flows nicely", "You have some interesting ideas"], 
            ebi: ["Use some connectives/time phrases to link your sentences together and give some fluency to your work", "Use connectives/time phrases more often to link your sentences together and give some fluency to your work", "Use punctuation in the same way you would in English. It will give more fluency and clarity to your work", "Balance your work : try to have a similar amount of details for all your parts"] 
        }
    };

    function init() {
        const tbody = document.getElementById('table-body');
        Object.keys(feedback).forEach(cat => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td class="cat-cell">${cat}</td>
                <td>${createDropdown(cat, 'www')}</td>
                <td>${createDropdown(cat, 'ebi')}</td>
            `;
            tbody.appendChild(tr);
        });

        document.addEventListener('click', (e) => {
            if (!e.target.closest('.dropdown-container')) {
                document.querySelectorAll('.dropdown-menu').forEach(m => m.classList.remove('show'));
            }
        });
    }

    function createDropdown(cat, type) {
        const phrases = feedback[cat][type];
        let itemsHtml = phrases.map(p => {
            const isTense = p.includes("abc");
            return `
                <div class="dropdown-item" onclick="event.stopPropagation()">
                    <input type="checkbox" class="fb-cb" data-type="${type}" data-raw="${p}" onchange="update(this)">
                    <span>${p.replace("abc", "...")}</span>
                    ${isTense ? `<select class="tense-inline" onchange="update(this)">${tenses.map(t=>`<option value="${t}">${t}</option>`).join('')}</select>` : ''}
                </div>
            `;
        }).join('');

        return `
            <div class="dropdown-container">
                <button class="dropdown-button" onclick="toggleMenu(this)">Select... <span class="badge" style="display:none">0</span></button>
                <div class="dropdown-menu">${itemsHtml}</div>
            </div>
        `;
    }

    function toggleMenu(btn) {
        const menu = btn.nextElementSibling;
        const isOpen = menu.classList.contains('show');
        document.querySelectorAll('.dropdown-menu').forEach(m => m.classList.remove('show'));
        if (!isOpen) menu.classList.add('show');
    }

    function update(el) {
        const container = el.closest('.dropdown-container');
        const count = container.querySelectorAll('.fb-cb:checked').length;
        const badge = container.querySelector('.badge');
        badge.style.display = count > 0 ? 'inline' : 'none';
        badge.innerText = count;

        const cbs = document.querySelectorAll('.fb-cb');
        let www = [], ebi = [];

        cbs.forEach(cb => {
            if (cb.checked) {
                let text = cb.dataset.raw;
                const tenseSel = cb.parentElement.querySelector('.tense-inline');
                if (tenseSel) text = text.replace("abc", tenseSel.value);
                
                if (cb.dataset.type === 'www') www.push("✔ " + text);
                else ebi.push("✒ " + text);
            }
        });

        const out = document.getElementById('output');
        let res = "";
        if (www.length > 0) res += "WWW:\n" + www.join('\n') + "\n\n";
        if (ebi.length > 0) res += "EBI:\n" + ebi.join('\n');
        out.innerText = res || "Select phrases...";
    }

    function copyResult() {
        navigator.clipboard.writeText(document.getElementById('output').innerText);
        alert("Feedback Copied!");
    }

    function resetForm() {
        document.querySelectorAll('.fb-cb').forEach(c => c.checked = false);
        document.querySelectorAll('.badge').forEach(b => b.style.display = 'none');
        update(document.body);
    }

    init();
</script>
</body>
</html>
