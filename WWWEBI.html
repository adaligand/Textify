<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feedback Dashboard</title>
    <style>
        :root {
            --bg-color: #f0f2f5;
            --border-color: #dcdfe3;
            --panel-bg: #ffffff;
            --accent-grey: #5a6268;
        }

        body {
            font-family: 'Segoe UI', Tahoma, sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
        }

        .dashboard {
            display: grid;
            grid-template-columns: 1.5fr 1fr; /* Side-by-side layout */
            gap: 20px;
            max-width: 1400px;
            width: 100%;
        }

        .panel {
            background: var(--panel-bg);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        h2 { font-weight: 400; color: var(--accent-grey); margin-top: 0; border-bottom: 1px solid var(--bg-color); padding-bottom: 10px; }

        /* Table Styling */
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid var(--border-color); padding: 10px; text-align: left; vertical-align: top; }
        th { background: #f8f9fa; font-size: 0.75rem; text-transform: uppercase; color: #888; }
        
        .cat-name { font-weight: 600; width: 100px; color: #444; }

        .option-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 4px 0;
            font-size: 0.9rem;
        }

        /* Tense Selector */
        .tense-select {
            padding: 2px;
            font-size: 0.8rem;
            border: 1px solid #ccc;
            border-radius: 3px;
            background-color: #fffde7; /* Highlighted to show it's a menu */
        }

        /* Output Column Styling */
        .sticky-side {
            position: sticky;
            top: 20px;
            height: fit-content;
        }

        .output-box {
            background: #fafafa;
            border: 1px solid var(--border-color);
            padding: 15px;
            min-height: 250px;
            white-space: pre-line;
            font-family: 'Consolas', monospace;
            font-size: 0.95rem;
            margin-bottom: 15px;
        }

        .btn-group { display: flex; gap: 10px; }
        button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: 0.2s;
        }
        .copy-btn { background: var(--accent-grey); color: white; }
        .clear-btn { background: #e2e2e2; color: #333; }
        button:hover { opacity: 0.9; }

        @media (max-width: 900px) {
            .dashboard { grid-template-columns: 1fr; }
            .sticky-side { position: static; }
        }
    </style>
</head>
<body>

<div class="dashboard">
    <div class="panel">
        <h2>Feedback Selection</h2>
        <table>
            <thead>
                <tr>
                    <th>Category</th>
                    <th>WWW</th>
                    <th>EBI</th>
                </tr>
            </thead>
            <tbody id="table-body">
                </tbody>
        </table>
    </div>

    <div class="panel sticky-side">
        <h2>Formatted Feedback</h2>
        <div id="output" class="output-box">Select options to begin...</div>
        <div class="btn-group">
            <button class="copy-btn" onclick="copyText()">Copy Result</button>
            <button class="clear-btn" onclick="resetAll()">Clear</button>
        </div>
    </div>
</div>

<script>
    const tenseOptions = ["past", "present", "future", "conditional", "imperfect"];

    const data = [
        { cat: "Content", 
          www: ["You covered all the bullet points", "You developed most of your answers"], 
          ebi: ["Develop your points further"] },
        { cat: "Accuracy", 
          www: ["Your work is very accurate"], 
          ebi: ["Check your verb endings"] },
        { cat: "Vocab", 
          www: ["Your vocab and ideas are varied"], 
          ebi: ["Use a wider range of adjectives"] },
        { cat: "Op/reasons", 
          www: ["You provided a good range of opinions"], 
          ebi: ["Justify your opinions more clearly"] },
        { cat: "Tenses", 
          www: ["You used your tenses successfully", "You used the abc tense correctly"], 
          ebi: ["Check your use of the abc tense", "Try to include the abc tense"] },
        { cat: "Complexity", 
          www: ["Used complex phrases well"], 
          ebi: ["Use a wider range of complex phrases"] },
        { cat: "Fluency", 
          www: ["Work flows naturally"], 
          ebi: ["Improve paragraph transitions"] }
    ];

    function init() {
        const tbody = document.getElementById('table-body');
        data.forEach(item => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td class="cat-name">${item.cat}</td>
                <td>${generateInputs(item.www, 'www')}</td>
                <td>${generateInputs(item.ebi, 'ebi')}</td>
            `;
            tbody.appendChild(tr);
        });
    }

    function generateInputs(phrases, type) {
        return phrases.map(p => {
            const isDynamic = p.includes("abc");
            let html = `<div class="option-item">
                <input type="checkbox" class="fb-check" data-type="${type}" data-raw="${p}" onchange="update()">
                <span>${p.replace("abc", "______")}</span>`;
            
            if (isDynamic) {
                html += `<select class="tense-select" onchange="update()">
                    ${tenseOptions.map(t => `<option value="${t}">${t}</option>`).join('')}
                </select>`;
            }
            html += `</div>`;
            return html;
        }).join('');
    }

    function update() {
        const checks = document.querySelectorAll('.fb-check');
        let www = [];
        let ebi = [];

        checks.forEach(cb => {
            if (cb.checked) {
                let text = cb.getAttribute('data-raw');
                const select = cb.parentElement.querySelector('.tense-select');
                if (select) {
                    text = text.replace("abc", select.value);
                }

                if (cb.dataset.type === 'www') www.push("✓ " + text);
                else ebi.push("⮕ " + text);
            }
        });

        const output = document.getElementById('output');
        let result = "";
        if (www.length > 0) result += "WWW:\n" + www.join('\n') + "\n\n";
        if (ebi.length > 0) result += "EBI:\n" + ebi.join('\n');
        
        output.innerText = result || "Select options to begin...";
    }

    function copyText() {
        const text = document.getElementById('output').innerText;
        navigator.clipboard.writeText(text);
        alert("Feedback copied!");
    }

    function resetAll() {
        document.querySelectorAll('.fb-check').forEach(cb => cb.checked = false);
        update();
    }

    init();
</script>

</body>
</html>
