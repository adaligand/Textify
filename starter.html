<style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background-color: #f0f2f5;
      color: #1c1e21;
      margin: 0;
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh; 
    }
    .container {
      width: 100%;
      max-width: 1400px;
      background: #fff;
      padding: 25px 30px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      min-height: calc(100vh - 40px); 
    }
    h1, h2 { text-align: center; color: #333; }
    .hide { display: none !important; }

    /* --- MENU --- */
    #main-menu { text-align: center; }
    #main-menu .menu-buttons {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 30px;
    }
    .menu-button {
      font-size: 1.2em;
      padding: 20px 40px;
      border-radius: 10px;
      border: none;
      color: white;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .menu-button:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 15px rgba(0,0,0,0.15);
    }
    #reading-btn { background-color: #2980b9; }
    #listening-btn { background-color: #27ae60; }
    #vocab-btn { background-color: #8e44ad; }

    /* --- BUTTON STYLE --- */
    button {
      border: none;
      border-radius: 8px;
      font-size: 1em;
      font-weight: 600;
      cursor: pointer;
      padding: 12px 20px;
      transition: background-color 0.2s ease, transform 0.1s ease;
    }
    button:hover { transform: translateY(-2px); }
    .btn-primary { background-color: #2980b9; color: #fff; }
    .btn-primary:hover { background-color: #3498db; }
    .btn-secondary {
      background-color: #6c757d;
      color: white;
    }
    .btn-secondary:hover {
      background-color: #5a6268;
    }

    /* --- PRACTICE --- */
    .practice-controls {
      display: flex;
      gap: 15px;
      margin-bottom: 25px;
      align-items: flex-end;
      flex-wrap: wrap; 
    }
    .practice-control-group {
      flex-grow: 1;
      min-width: 200px; 
      display: flex;
      flex-direction: column;
    }
    label { font-weight: 600; margin-bottom: 8px; color: #606770; }
    select {
      font-size: 16px;
      padding: 12px;
      border-radius: 8px;
      border: 1px solid #dddfe2;
      background-color: #f5f6f7;
    }
    #question-display {
      border: 1px solid #e0e0e0;
      border-radius: 12px;
      padding: 20px;
      min-height: 400px;
      background-color: #fafafa;
    }
    #question-display iframe {
      width: 100%;
      height: 500px;
      border-radius: 8px;
      border: none;
    }

    /* --- VOCAB --- */
    .vocab-main-wrapper { 
        display: flex; 
        gap: 30px; 
        margin-top: 20px; 
    }
    .vocab-test-panel { 
        flex-grow: 1; 
    }
    .vocab-controls-panel {
      flex: 0 0 250px; 
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    .vocab-control-group {
      background-color: #f9f9f9;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    #vocab-setup-controls {
      display: grid;
      grid-template-columns: auto 150px; 
      gap: 15px;
      align-items: center;
    }
    
    #vocab-setup-controls select {
        max-width: 100%; 
        box-sizing: border-box;
    }
    
    #vocab-setup-controls label {
        margin-bottom: 0;
        text-align: right;
        white-space: normal;
        line-height: 1.2;
    }
    
    #vocab-setup-controls button {
        grid-column: 1 / -1;
        white-space: nowrap; 
        width: 100%;
    }

    #vocab-test-controls {
        flex-direction: row; 
        flex-wrap: wrap;
        padding: 15px; 
    }

    #vocab-test-controls button {
        flex: 1 1 45%; 
        min-width: 100px;
        margin: 5px; 
        white-space: nowrap;
    }

    .vocab-controls-panel > .back-btn {
        width: 100%; 
        box-sizing: border-box;
    }
    
    /* --- On-screen Table Styles --- */
    #vocab-test-container {
      width: 100%;
    }
    #vocab-test-container table {
      width: 100%;
      border-collapse: collapse;
      font-size: 1.4em;
      table-layout: fixed; 
    }
    #vocab-test-container th, #vocab-test-container td {
      border: 1px solid #ddd;
      padding: 12px;
      text-align: left;
    }
    #vocab-test-container th:first-child,
    #vocab-test-container td.num-cell {
      width: 60px;
      text-align: center;
    }
    #vocab-test-container th:nth-child(2),
    #vocab-test-container td:nth-child(2),
    #vocab-test-container th:nth-child(3),
    #vocab-test-container td:nth-child(3) {
      width: 47%; 
    }

    .answer-cell span { visibility: hidden; color: #27ae60; font-weight: bold; }
    .answer-cell span.visible { visibility: visible; }
    
    #vocab-print-copy-area { display: none; }

    /* --- PRINT STYLES (FINAL SINGLE-PAGE FIT FIX) --- */
    @media print {
        /* 1. Page Setup */
        @page { 
            size: A4 landscape; 
            margin: 1cm; 
        }
        
        /* 2. Reset Body and Container */
        body, .container {
            padding: 0; margin: 0; 
            background: none !important; 
            display: block !important; 
            width: 100% !important;
            box-shadow: none !important;
            height: auto !important; 
            min-height: auto !important; 
            overflow: hidden !important; 
        }

        /* 3. Hide ALL UI/Control Elements */
        .container > :not(#vocab-section),
        #vocab-section > :not(.vocab-main-wrapper),
        .vocab-main-wrapper > :not(.vocab-test-panel) {
            display: none !important;
        }

        /* 4. Show the main section and hide its non-print parts */
        #vocab-section, .vocab-main-wrapper {
            display: block !important; 
            width: 100%; margin: 0; padding: 0;
            height: auto !important; min-height: auto !important;
        }
        
        /* 5. The Two-Column Flexbox Engine */
        .vocab-test-panel {
            display: flex !important; 
            justify-content: space-between;
            gap: 20px;
            width: 100%;
            height: 98vh; 
            padding: 0;
            box-shadow: none;
            background: none;
        }

        /* 6. Styling for the two table wrappers */
        #vocab-test-container, 
        #vocab-print-copy-area {
            display: flex !important; 
            flex-direction: column;
            width: 49%; 
            height: 100%;
            page-break-inside: avoid; 
            box-sizing: border-box;
            margin: 0;
        }
        
        /* 7. Apply flex layout to the table itself */
        #vocab-test-container table,
        #vocab-print-copy-area table {
            width: 100%; 
            border-collapse: collapse;
            font-size: 11pt; 
            table-layout: fixed;
            display: flex;
            flex-direction: column;
            height: 100%; 
        }
        
        /* 8. Make the table body expand to fill available space */
        #vocab-test-container tbody,
        #vocab-print-copy-area tbody {
            flex-grow: 1; 
            display: flex; 
            flex-direction: column; 
        }

        /* 9. Make each row expand equally within the table body */
        #vocab-test-container tbody tr,
        #vocab-print-copy-area tbody tr {
            flex-grow: 1; 
            display: table; 
            width: 100%;
            table-layout: fixed;
        }
        
        /* 10. Style the cells */
        #vocab-test-container th, #vocab-test-container td,
        #vocab-print-copy-area th, #vocab-print-copy-area td { 
            border: 1px solid #000; 
            padding: 4px 6px; 
            vertical-align: top;
            /* Height is now controlled by flex, do not set it here */
        }

        /* 11. Column widths */
        #vocab-test-container th:first-child,
        #vocab-test-container td.num-cell,
        #vocab-print-copy-area th:first-child,
        #vocab-print-copy-area td.num-cell {
            width: 40px; 
            text-align: center;
        }
        
        /* Hide answers */
        .answer-cell span { 
            visibility: hidden !important; 
        }
    }
</style>
