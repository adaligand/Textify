<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Language Hub</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
<style>
Â  body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background:#f0f2f5; color:#1c1e21; margin:0; padding:20px; display:flex; justify-content:center; align-items:flex-start; min-height:100vh; }
Â  .container { width:100%; max-width:1400px; background:#fff; padding:25px 30px; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.1); }
Â  h1,h2 { text-align:center; color:#333; }
Â  .hide { display:none !important; }

Â  /* menu */
Â  #main-menu { text-align:center; }
Â  .menu-buttons { display:flex; justify-content:center; gap:20px; margin-top:30px; }
Â  .menu-button { font-size:1.2em; padding:20px 40px; border-radius:10px; border:none; color:#fff; cursor:pointer; transition:transform .2s,box-shadow .2s; }
Â  .menu-button:hover { transform:translateY(-3px); box-shadow:0 6px 15px rgba(0,0,0,0.15); }
Â  #reading-btn { background:#2980b9; } #listening-btn { background:#27ae60; } #vocab-btn { background:#8e44ad; }

Â  button { border:none; border-radius:8px; font-size:1em; font-weight:600; cursor:pointer; padding:12px 20px; transition:background-color .2s ease, transform .1s ease; white-space:nowrap; }
Â  button:hover { transform:translateY(-2px); }
Â  .btn-primary { background:#2980b9; color:#fff; } .btn-primary:hover { background:#3498db; }
Â  .btn-secondary { background:#6c757d; color:#fff; } .btn-secondary:hover { background:#5a6268; }

Â  .practice-controls { display:flex; gap:15px; margin-bottom:25px; align-items:flex-end; flex-wrap:wrap; }
Â  .practice-control-group { flex-grow:1; min-width:200px; display:flex; flex-direction:column; }
Â  label { font-weight:600; margin-bottom:8px; color:#606770; }

Â  select { font-size:16px; padding:12px; border-radius:8px; border:1px solid #dddfe2; background:#f5f6f7; }

Â  #question-display { border:1px solid #e0e0e0; border-radius:12px; padding:20px; min-height:400px; background:#fafafa; }
Â  #question-display iframe { width:100%; height:500px; border-radius:8px; border:none; }

Â  .vocab-main-wrapper { display:flex; gap:30px; margin-top:20px; }
Â  .vocab-test-panel { flex-grow:1; }
Â  .vocab-controls-panel { flex:0 0 350px; display:flex; flex-direction:column; gap:15px; }

Â  .vocab-control-group { background:#f9f9f9; border:1px solid #ddd; border-radius:8px; padding:20px; display:flex; flex-direction:column; gap:15px; }

Â  /* Vocab Display - Single Table (Original Layout) */
Â  #vocab-test-container table { width:100%; border-collapse:collapse; font-size:1.4em; table-layout:fixed; margin-top:20px; }
Â  #vocab-test-container th, #vocab-test-container td { border:1px solid #ddd; padding:12px; text-align:left; }
Â  #vocab-test-container th:first-child, #vocab-test-container td.num-cell { width:60px; text-align:center; }
Â  #vocab-test-container th:nth-child(2), #vocab-test-container td:nth-child(2), #vocab-test-container th:nth-child(3), #vocab-test-container td:nth-child(3) { width:47%; }

Â  .answer-cell span { visibility:hidden; color:#27ae60; font-weight:bold; }
Â  .answer-cell span.visible { visibility:visible; }

Â  /* print - REVISED FOR 2 COPIES ON A4 LANDSCAPE */
Â  @media print {
Â  Â  @page { 
Â  Â  Â  size: A4 landscape;
Â  Â  Â  margin: 0;
Â  Â  }
Â  Â  .container, #main-menu, #practice-section, .vocab-controls-panel { display:none !important; }
Â  Â  
Â  Â  #vocab-section { 
Â  Â  Â  display: block !important; 
Â  Â  Â  position: absolute; 
Â  Â  Â  top: 0; 
Â  Â  Â  left: 0; 
Â  Â  Â  width: 100%; 
Â  Â  Â  padding: 0; 
Â  Â  Â  margin: 0; 
Â  Â  }
Â  Â  
Â  Â  #vocab-test-container { display:none !important; } /* Hide the visible container */
Â  Â  
Â  Â  #vocab-print-wrapper { /* This wrapper is shown ONLY during print */
Â  Â  Â  display: flex !important;
Â  Â  Â  width: 100%;
Â  Â  Â  height: 100%;
Â  Â  Â  padding: 1cm;
Â  Â  Â  justify-content: space-between;
Â  Â  Â  box-sizing: border-box;
Â  Â  }
Â  Â  
Â  Â  .vocab-print-copy {
Â  Â  Â  width: 48%; /* Slightly less than 50% to account for spacing */
Â  Â  Â  box-sizing: border-box;
Â  Â  }

Â  Â  /* Styles for the tables inside the print copies */
Â  Â  .vocab-print-copy table { 
Â  Â  Â  width: 100%; 
Â  Â  Â  border-collapse: collapse; 
Â  Â  Â  font-size: 11pt; 
Â  Â  Â  page-break-inside: avoid; 
Â  Â  Â  margin-bottom: 0; 
Â  Â  Â  table-layout: fixed; 
Â  Â  }
Â  Â  .vocab-print-copy th, .vocab-print-copy td { 
Â  Â  Â  border: 1px solid #000; 
Â  Â  Â  padding: 5px 8px; 
Â  Â  Â  line-height: 1.2; 
Â  Â  }
Â  Â  .vocab-print-copy th:first-child, .vocab-print-copy td.num-cell { 
Â  Â  Â  width: 50px; 
Â  Â  Â  text-align: center;
Â  Â  }
Â  Â  .vocab-print-copy th:nth-child(2), .vocab-print-copy td:nth-child(2), .vocab-print-copy th:nth-child(3), .vocab-print-copy td:nth-child(3) { 
Â  Â  Â  width: calc(50% - 25px); 
Â  Â  }
Â  Â  .answer-cell span { visibility:hidden !important; }
Â  }
</style>
</head>
<body>
<div class="container">

Â  <div id="main-menu">
Â  Â  <h1>Language Practice Hub</h1>
Â  Â  <p>Please choose an activity</p>
Â  Â  <div class="menu-buttons">
Â  Â  Â  <button id="reading-btn" class="menu-button">Reading Practice</button>
Â  Â  Â  <button id="listening-btn" class="menu-button">Listening Practice</button>
Â  Â  Â  <button id="vocab-btn" class="menu-button">Vocabulary Test</button>
Â  Â  </div>
Â  </div>

Â  <div id="practice-section" class="hide">
Â  Â  <h1 id="practice-title">Practice Section</h1>
Â  Â  <input type="hidden" id="current-practice-type" value="">
Â  Â  <div class="practice-controls">
Â  Â  Â  <div class="practice-control-group">
Â  Â  Â  Â  <label for="topic-select">Choose a Theme:</label>
Â  Â  Â  Â  <select id="topic-select"><option>Loading Themes...</option></select>
Â  Â  Â  </div>
Â  Â  Â  <div class="practice-control-group">
Â  Â  Â  Â  <label for="question-select">Choose a Question:</label>
Â  Â  Â  Â  <select id="question-select"><option>Select a Theme first...</option></select>
Â  Â  Â  </div>
Â  Â  Â  <button id="generate-practice-btn" class="btn-primary">Load Question</button>
Â  Â  Â  <button id="fullscreen-btn" class="btn-primary hide">ğŸ”ˆ Open Full Screen</button>
Â  Â  Â  <button class="btn-primary back-btn">Back to Main Menu</button>
Â  Â  </div>
Â  Â  <div id="question-display">
Â  Â  Â  <h2>Your question will appear here</h2>
Â  Â  Â  <p>Select a theme and question, then click "Load Question".</p>
Â  Â  </div>
Â  </div>

Â  <div id="vocab-section" class="hide">
Â  Â  <div class="vocab-main-wrapper">
Â  Â  Â  <div class="vocab-test-panel">
Â  Â  Â  Â  Â  Â  Â  Â  <div id="vocab-test-container" class="hide">
Â  Â  Â  Â  Â  <table>
Â  Â  Â  Â  Â  Â  <thead><tr><th>No.</th><th>Target Language</th><th>English</th></tr></thead>
Â  Â  Â  Â  Â  Â  <tbody id="vocab-test-body"></tbody>
Â  Â  Â  Â  Â  </table>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="vocab-print-wrapper" style="display:none;"></div>
Â  Â  Â  </div>

Â  Â  Â  <div class="vocab-controls-panel" id="vocab-controls-panel">
Â  Â  Â  Â  <h1>Vocabulary Test</h1>
Â  Â  Â  Â  <div id="vocab-setup-controls" class="vocab-control-group">
Â  Â  Â  Â  Â  <div style="display:flex; align-items:center; justify-content:space-between;">
Â  Â  Â  Â  Â  Â  <label for="vocab-theme-select">Theme:</label>
Â  Â  Â  Â  Â  Â  <select id="vocab-theme-select" style="width:60%;"></select>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div style="display:flex; align-items:center; justify-content:space-between;">
Â  Â  Â  Â  Â  Â  <label for="vocab-set-select">Set:</label>
Â  Â  Â  Â  Â  Â  <select id="vocab-set-select" style="width:60%;"></select>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div style="display:flex; align-items:center; justify-content:space-between;">
Â  Â  Â  Â  Â  Â  <label for="vocab-set-select-2">2nd set (Optional):</label>
Â  Â  Â  Â  Â  Â  <select id="vocab-set-select-2" style="width:60%;"></select>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <button id="vocab-generate-btn" class="btn-primary">Generate List</button>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="vocab-action-buttons" style="margin-top:15px; display:flex; flex-direction:column; gap:10px;">
Â  Â  Â  Â  Â  <button id="vocab-reveal-btn" class="btn-primary">Reveal Answers</button>
Â  Â  Â  Â  Â  <button id="vocab-print-btn" class="btn-primary">ğŸ–¨ï¸ Print Test</button>
Â  Â  Â  Â  Â  <button class="btn-primary back-btn">Back to Main Menu</button>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  </div>
Â  </div>
</div>

<script>
/* URLs */
const practiceSheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRvNFlHDx-4cZbDzwKy5Yb_DKeSxS2wSXxyX1Ua6pGcf27yFjmqOPz9jQ_rzoV3-zoZI9lw4EIfmdXH/pub?output=csv";
const vocabSheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSCNeq329ih6SxLZ2TowPzpk61gJLFy-UAVAb8ivBs9DNEOdmtRQ29bWh__n53MdE-C8hs_XOV3iIkT/pub?output=csv";

/* state */
let practice_allQuestions = [];
let vocab_vocabSets = {};
let currentPracticeContentURL = ''; // To store the content URL for the fullscreen button

/* DOM refs */
const mainMenu = document.getElementById('main-menu');
const practiceSection = document.getElementById('practice-section');
const vocabSection = document.getElementById('vocab-section');
const readingBtn = document.getElementById('reading-btn');
const listeningBtn = document.getElementById('listening-btn');
const vocabBtn = document.getElementById('vocab-btn');
const currentPracticeTypeInput = document.getElementById('current-practice-type');

const practice_topicSelect = document.getElementById('topic-select');
const practice_questionSelect = document.getElementById('question-select');
const practice_generateBtn = document.getElementById('generate-practice-btn');
const practice_questionDisplay = document.getElementById('question-display');
const fullscreenBtn = document.getElementById('fullscreen-btn');

const vocab_themeSelect = document.getElementById('vocab-theme-select');
const vocab_setSelect = document.getElementById('vocab-set-select');
const vocab_setSelect2 = document.getElementById('vocab-set-select-2');
const vocab_generateBtn = document.getElementById('vocab-generate-btn');
const vocab_testContainer = document.getElementById('vocab-test-container'); // Visible container
const vocab_printWrapper = document.getElementById('vocab-print-wrapper'); // Hidden print container
const vocab_testBody = document.getElementById('vocab-test-body');
const vocab_revealBtn = document.getElementById('vocab-reveal-btn');

/* navigation */
readingBtn.addEventListener('click', () => showPractice('Reading'));
listeningBtn.addEventListener('click', () => showPractice('Listening'));
vocabBtn.addEventListener('click', showVocabTest);
document.querySelectorAll('.back-btn').forEach(btn => btn.addEventListener('click', showMainMenu));

function showMainMenu() {
Â  mainMenu.classList.remove('hide');
Â  practiceSection.classList.add('hide');
Â  vocabSection.classList.add('hide');
}

function showPractice(type) {
Â  mainMenu.classList.add('hide');
Â  practiceSection.classList.remove('hide');
Â  vocabSection.classList.add('hide');
Â  document.getElementById('practice-title').textContent = `${type} Practice`;
Â  currentPracticeTypeInput.value = type;
Â  practice_populateTopics();
}

function showVocabTest() {
Â  mainMenu.classList.add('hide');
Â  practiceSection.classList.add('hide');
Â  vocabSection.classList.remove('hide');

Â  // RESET THE TEST
Â  vocab_testBody.innerHTML = '';
Â  vocab_testContainer.classList.add('hide');
Â  vocab_printWrapper.innerHTML = ''; // Clear the hidden print wrapper
Â  vocab_themeSelect.value = '';
Â  vocab_setSelect.innerHTML = '';
Â  vocab_setSelect2.innerHTML = '';
Â  vocab_revealBtn.textContent = 'Reveal Answers';
}

/* CSV loader */
function loadData(url, options) {
Â  return new Promise((resolve, reject) => {
Â  Â  Papa.parse(url, {
Â  Â  Â  ...options,
Â  Â  Â  download: true,
Â  Â  Â  skipEmptyLines: true,
Â  Â  Â  complete: results => resolve(results.data),
Â  Â  Â  error: err => reject(err)
Â  Â  });
Â  });
}

/* initialize app */
async function initializeApp() {
Â  readingBtn.disabled = true; listeningBtn.disabled = true; vocabBtn.disabled = true;
Â  try {
Â  Â  const [practiceData, vocabData] = await Promise.all([
Â  Â  Â  loadData(practiceSheetUrl, { header: true }),
Â  Â  Â  loadData(vocabSheetUrl, { header: false })
Â  Â  ]);

Â  Â  practice_allQuestions = practiceData.map(row => ({
Â  Â  Â  Skill: (row.Skill || "").trim(),
Â  Â  Â  Theme: (row.Theme || "").trim(),
Â  Â  Â  Question: (row.Question || "").trim(),
Â  Â  Â  Content: (row.Content || "").trim()
Â  Â  })).filter(q => q.Skill && q.Theme && q.Content);

Â  Â  // vocab parsing
Â  Â  vocab_vocabSets = {};
Â  Â  let currentTheme = null, currentKey = null;
Â  Â  vocabData.forEach(row => {
Â  Â  Â  if (!row) return;
Â  Â  Â  const rawTheme = (row[0] || "").trim();
Â  Â  Â  const setId = (row[1] || "").trim();
Â  Â  Â  const target = (row[3] || "").trim();
Â  Â  Â  const english = (row[4] || "").trim();

Â  Â  Â  if (rawTheme) currentTheme = rawTheme;
Â  Â  Â  if (setId) currentKey = `${currentTheme}.${setId}`;
Â  Â  Â  if (!currentTheme || !currentKey) return;

Â  Â  Â  if (target && english) {
Â  Â  Â  Â  if (!vocab_vocabSets[currentKey]) vocab_vocabSets[currentKey] = [];
Â  Â  Â  Â  vocab_vocabSets[currentKey].push({ target, english });
Â  Â  Â  }
Â  Â  });

Â  Â  vocab_initializeSelectors();
Â  Â  readingBtn.disabled = false; listeningBtn.disabled = false; vocabBtn.disabled = false;
Â  } catch (err) {
Â  Â  console.error("Load error:", err);
Â  Â  document.querySelector('.container').innerHTML = '<h1>Error</h1><p>Could not load spreadsheet data. Check URLs & publishing.</p>';
Â  }
}

/* practice logic */
function practice_populateTopics() {
Â  const skill = currentPracticeTypeInput.value; // Reading or Listening
Â  const themes = [...new Set(practice_allQuestions
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â .filter(q => q.Skill.toLowerCase() === skill.toLowerCase())
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â .map(q => q.Theme))].sort();

Â  practice_topicSelect.innerHTML = '';
Â  themes.forEach(theme => {
Â  Â  const opt = document.createElement('option');
Â  Â  opt.value = theme;
Â  Â  opt.textContent = theme;
Â  Â  practice_topicSelect.appendChild(opt);
Â  });

Â  // Initially populate questions for the first theme (if any)
Â  if (themes.length > 0) {
Â  Â  practice_populateQuestions(themes[0]);
Â  } else {
Â  Â  practice_questionSelect.innerHTML = '<option>No Questions Available</option>';
Â  }
}

function practice_populateQuestions(selectedTheme) {
Â  const skill = currentPracticeTypeInput.value;
Â Â 
Â  // Filter questions based on the selected theme AND the current skill
Â  const questions = practice_allQuestions
Â  Â  .filter(q => q.Skill.toLowerCase() === skill.toLowerCase() && q.Theme === selectedTheme)
Â  Â  .map(q => q.Question)
Â  Â  .sort();

Â  practice_questionSelect.innerHTML = '';
Â Â 
Â  if (questions.length === 0) {
Â  Â  const opt = document.createElement('option');
Â  Â  opt.textContent = 'No questions for this theme.';
Â  Â  practice_questionSelect.appendChild(opt);
Â  } else {
Â  Â  questions.forEach(question => {
Â  Â  Â  const opt = document.createElement('option');
Â  Â  Â  opt.value = question;
Â  Â  Â  opt.textContent = question;
Â  Â  Â  practice_questionSelect.appendChild(opt);
Â  Â  });
Â  }
}

// Event Listeners for practice section
practice_topicSelect.addEventListener('change', (event) => {
Â  Â  practice_populateQuestions(event.target.value);
});

practice_generateBtn.addEventListener('click', practice_loadQuestion);

function practice_loadQuestion() {
Â  Â  const selectedTheme = practice_topicSelect.value;
Â  Â  const selectedQuestion = practice_questionSelect.value;
Â  Â  const skill = currentPracticeTypeInput.value;

Â  Â  const questionData = practice_allQuestions.find(q =>Â 
Â  Â  Â  Â  q.Skill.toLowerCase() === skill.toLowerCase() &&Â 
Â  Â  Â  Â  q.Theme === selectedTheme &&Â 
Â  Â  Â  Â  q.Question === selectedQuestion
Â  Â  );

Â  Â  if (questionData && questionData.Content) {
Â  Â  Â  Â  currentPracticeContentURL = questionData.Content; // Store URL for fullscreen
        
        // Use the placeholder guide due to Google Docs embed restrictions
Â  Â  Â  Â  practice_questionDisplay.innerHTML = `
            <h2>Content Loaded: ${selectedQuestion}</h2>
            <p style="font-size: 1.1em;">
                The content (Google Slides/Docs) often cannot be displayed correctly in this embedded frame 
                due to security and embedding restrictions.
                <br><br>
                <strong>Please click the "Open Full Screen" button below to view the full content in a new tab.</strong>
            </p>
            <a href="${currentPracticeContentURL}" target="_blank" class="btn-primary" 
               style="display: inline-block; margin-top: 20px; text-decoration: none;">
                Open ${skill} Content in New Tab
            </a>
            `;
Â  Â  Â  Â  fullscreenBtn.classList.remove('hide');
Â  Â  } else {
Â  Â  Â  Â  practice_questionDisplay.innerHTML = '<h2>Error</h2><p>Could not find content for the selected question.</p>';
Â  Â  Â  Â  fullscreenBtn.classList.add('hide');
Â  Â  Â  Â  currentPracticeContentURL = '';
Â  Â  }
}

fullscreenBtn.addEventListener('click', () => {
Â  Â  if (currentPracticeContentURL) {
Â  Â  Â  Â  window.open(currentPracticeContentURL, '_blank');
Â  Â  }
});

/* vocab logic */
function vocab_initializeSelectors() {
Â  const themes = [...new Set(Object.keys(vocab_vocabSets).map(k => k.split('.')[0]))].filter(Boolean).sort();
Â  vocab_themeSelect.innerHTML = '<option value="">-- Select Theme --</option>';
Â  themes.forEach(theme => {
Â  Â  const opt = document.createElement('option');
Â  Â  opt.value = theme;
Â  Â  opt.textContent = theme;
Â  Â  vocab_themeSelect.appendChild(opt);
Â  });

Â  vocab_themeSelect.addEventListener('change', vocab_updateSetDropdown);
Â  vocab_generateBtn.addEventListener('click', vocab_generateTest);
Â  vocab_revealBtn.addEventListener('click', () => {
Â  Â  // Target spans in BOTH the visible and hidden print tables
Â  Â  const allSpans = document.querySelectorAll('.answer-cell span');
Â  Â  const anyHidden = Array.from(allSpans).some(s => !s.classList.contains('visible'));
Â  Â  allSpans.forEach(s => s.classList.toggle('visible', anyHidden));
Â  Â  vocab_revealBtn.textContent = anyHidden ? 'Hide Answers' : 'Reveal Answers';
Â  });
Â  
Â  document.getElementById('vocab-print-btn').addEventListener('click', () => {
Â  Â  // Ensure a test is generated before printing
Â  Â  if (vocab_testBody.children.length > 0) {
Â  Â  Â  // Since vocab_generateTest prepares vocab_printWrapper, we just print
Â  Â  Â  window.print();
Â  Â  } else {
Â  Â  Â  alert("Please generate a vocabulary list first.");
Â  Â  }
Â  });
}

function vocab_updateSetDropdown() {
Â  const theme = vocab_themeSelect.value;
Â  vocab_setSelect.innerHTML = '';
Â  vocab_setSelect2.innerHTML = '';
Â  const noneOpt = document.createElement('option');
Â  noneOpt.value = '';
Â  noneOpt.textContent = '-- None --';
Â  vocab_setSelect2.appendChild(noneOpt);

Â  if (!theme) {
Â  Â  vocab_setSelect.innerHTML = '<option value="">Select Theme First</option>';
Â  Â  return;
Â  }

Â  const setKeys = Object.keys(vocab_vocabSets).filter(k => k.startsWith(theme + '.')).sort();
Â  if (setKeys.length === 0) {
Â  Â  vocab_setSelect.innerHTML = '<option value="">No Sets Available</option>';
Â  Â  return;
Â  }

Â  setKeys.forEach(key => {
Â  Â  const topicName = key.substring(key.indexOf('.') + 1);
Â  Â  const opt = document.createElement('option');
Â  Â  opt.value = key;
Â  Â  opt.textContent = `${topicName} (${vocab_vocabSets[key].length} words)`;
Â  Â  vocab_setSelect.appendChild(opt);
Â  Â  vocab_setSelect2.appendChild(opt.cloneNode(true));
Â  });
}

function vocab_generateTest() {
Â  const setKey1 = vocab_setSelect.value;
Â  if (!setKey1) return;
Â  let combined = Array.isArray(vocab_vocabSets[setKey1]) ? [...vocab_vocabSets[setKey1]] : [];
Â  const setKey2 = vocab_setSelect2.value;
Â  if (setKey2) combined = combined.concat(vocab_vocabSets[setKey2] || []);

Â  const unique = Array.from(new Map(combined.map(item => [item.target, item])).values());
Â  if (unique.length === 0) {
Â  Â  vocab_testBody.innerHTML = '';
Â  Â  vocab_testContainer.classList.add('hide');
Â  Â  vocab_printWrapper.innerHTML = ''; // Clear print data
Â  Â  return;
Â  }

Â  const shuffled = unique.sort(() => 0.5 - Math.random());
Â  vocab_testBody.innerHTML = '';

Â  // 1. Generate the table rows as HTML string
Â  const rowsHTML = shuffled.slice(0, 10).map((item, i) => {
Â  Â  const rowNumber = i + 1;
Â  Â  let targetCell, englishCell;
Â  Â  
Â  Â  // Alternate which column has the hidden answer (Target first for odd, English first for even)
Â  Â  if (i % 2 === 0) { 
Â  Â  Â  targetCell = `<td>${item.target}</td>`;
Â  Â  Â  englishCell = `<td class="answer-cell"><span>${item.english}</span></td>`;
Â  Â  } else { 
Â  Â  Â  targetCell = `<td class="answer-cell"><span>${item.target}</span></td>`;
Â  Â  Â  englishCell = `<td>${item.english}</td>`;
Â  Â  }
Â  Â  
Â  Â  return `<tr><td class="num-cell">${rowNumber}</td>${targetCell}${englishCell}</tr>`;
Â  }).join('');

Â  // 2. Populate the ON-SCREEN table's body
Â  vocab_testBody.innerHTML = rowsHTML;
Â  vocab_testContainer.classList.remove('hide');
Â  document.querySelectorAll('#vocab-test-container .answer-cell span').forEach(s => s.classList.remove('visible'));
Â  
Â  // 3. Populate the HIDDEN print wrapper with TWO copies
Â  const printTableHTML = `
Â  Â  <table>
Â  Â  Â  <thead><tr><th>No.</th><th>Target Language</th><th>English</th></tr></thead>
Â  Â  Â  <tbody>${rowsHTML}</tbody>
Â  Â  </table>
Â  `;

Â  // Clear and rebuild the print wrapper content
Â  vocab_printWrapper.innerHTML = `
Â  Â  <div class="vocab-print-copy">${printTableHTML}</div>
Â  Â  <div class="vocab-print-copy">${printTableHTML}</div>
Â  `;
}

/* Initialize app */
initializeApp();
</script>
</body>
</html>

